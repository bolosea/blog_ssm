(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{166:function(t,s,e){"use strict";e.r(s);var n=e(1),a=e.n(n),i=e(3),c=e.n(i),o=e(5),r={props:{comments:{type:Array,required:!0},articleId:{required:!0}},components:{},data:function(){return{inputComment:"",showItemId:"",showAdd:!1,showItemName:"",replyName:""}},computed:{},methods:{showAddHandle:function(){this.showAdd=!0},likeClick:function(t){null===t.isLike?(o.default.$set(t,"isLike",!0),t.likeNum++):(t.isLike?t.likeNum--:t.likeNum++,t.isLike=!t.isLike)},cancel:function(){this.inputComment="",this.showItemId="",this.showAdd=!1},commitComment:function(){var t=c()(a.a.mark(function t(){var s,e,n,i,c;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log(this.inputComment,this.articleId),s=JSON.parse(localStorage.getItem("user")),console.log("user",s),s){t.next=5;break}return t.abrupt("return",this.$message({type:"error",message:"请先登录!"}));case 5:return t.next=7,this.$http.post("/comment/add",{userId:s.id,articleId:this.articleId,content:this.inputComment,username:s.name||null,parentId:this.showItemId||null,parentName:this.showItemName||null});case 7:e=t.sent,console.log(e),n=e.data,i=n.code,c=n.msg,0===i&&(this.$message({type:"success",message:c}),this.$emit("getArticle"),this.cancel());case 11:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),showCommentInput:function(t,s){s?(this.replyName="@"+s.username+" ",this.showItemName=s.username):(this.inputComment="",this.showItemName=t.username),console.log("item",t),this.showItemId=t.id}},created:function(){console.log(this.comments)}},l=(e(223),e(2)),m={components:{Comment:Object(l.a)(r,function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("div",{staticClass:"container"},[n("div",{staticClass:"new-comment"},[n("div",{staticClass:"new-head"},[n("img",{staticClass:"avatar",attrs:{src:e(165),alt:""}}),t._v(" "),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.inputComment,expression:"inputComment"}],staticClass:"comment-content",attrs:{placeholder:"写下你的评论...",cols:"30",rows:"10"},domProps:{value:t.inputComment},on:{focus:t.showAddHandle,input:function(s){s.target.composing||(t.inputComment=s.target.value)}}})]),t._v(" "),t.showAdd?n("div",{staticClass:"btn-control"},[n("span",{staticClass:"cancel",on:{click:t.cancel}},[t._v("取消")]),t._v(" "),n("el-button",{staticClass:"btn",attrs:{type:"success",round:""},on:{click:t.commitComment}},[t._v("确定")])],1):t._e()]),t._v(" "),t.comments.length>0?n("div",{staticClass:"jingcai"},[n("span",[t._v("精彩评论("+t._s(t.comments.length)+")")])]):t._e(),t._v(" "),t._l(t.comments,function(s){return n("div",{key:s.id,staticClass:"comment"},[n("div",{staticClass:"info"},[n("img",{staticClass:"avatar",attrs:{src:s.fromAvatar,width:"36",height:"36"}}),t._v(" "),n("div",{staticClass:"right"},[n("div",{staticClass:"name"},[t._v(t._s(s.username))]),t._v(" "),n("div",{staticClass:"date"},[t._v(t._s(s.createTime))])])]),t._v(" "),n("div",{staticClass:"content"},[t._v(t._s(s.content))]),t._v(" "),n("div",{staticClass:"control"},[n("span",{staticClass:"like",class:{active:s.isLike},on:{click:function(e){return t.likeClick(s)}}},[n("i",{staticClass:"iconfont icon-like"}),t._v(" "),n("span",{staticClass:"like-num"},[t._v(t._s(s.likeNum>0?s.likeNum+"人赞":"赞"))])]),t._v(" "),n("span",{staticClass:"comment-reply",on:{click:function(e){return t.showCommentInput(s)}}},[n("i",{staticClass:"iconfont icon-comment"}),t._v(" "),n("span",[t._v("回复")])])]),t._v(" "),n("div",{staticClass:"reply"},[t._l(s.children,function(e){return n("div",{key:e.id,staticClass:"item"},[n("div",{staticClass:"reply-content"},[n("span",{staticClass:"from-name"},[t._v(t._s(e.username))]),t._v(" "),n("span",[t._v(":")]),t._v(" "),n("span",{staticClass:"to-name"},[t._v("@"+t._s(e.parentName))]),t._v(" "),n("span",[t._v(t._s(e.content))])]),t._v(" "),n("div",{staticClass:"reply-bottom"},[n("span",[t._v(t._s(e.createTime))]),t._v(" "),n("span",{staticClass:"reply-text",on:{click:function(n){return t.showCommentInput(s,e)}}},[n("i",{staticClass:"iconfont icon-comment"}),t._v(" "),n("span",[t._v("回复")])])])])}),t._v(" "),s.children.length>0?n("div",{staticClass:"write-reply",on:{click:function(e){return t.showCommentInput(s)}}},[n("i",{staticClass:"el-icon-edit"}),t._v(" "),n("span",{staticClass:"add-comment"},[t._v("添加新评论")])]):t._e(),t._v(" "),n("transition",{attrs:{name:"fade"}},[t.showItemId===s.id?n("div",{staticClass:"input-wrapper"},[t.replyName?n("el-tag",[t._v(t._s(t.replyName))]):t._e(),t._v(" "),n("el-input",{staticClass:"gray-bg-input",attrs:{type:"textarea",rows:3,autofocus:"",placeholder:"写下你的评论"},model:{value:t.inputComment,callback:function(s){t.inputComment=s},expression:"inputComment"}}),t._v(" "),n("div",{staticClass:"btn-control"},[n("span",{staticClass:"cancel",on:{click:t.cancel}},[t._v("取消")]),t._v(" "),n("el-button",{staticClass:"btn",attrs:{type:"success",round:""},on:{click:t.commitComment}},[t._v("确定")])],1)],1):t._e()])],2)])})],2)},[],!1,null,"5595a1c8",null).exports},data:function(){return{article:{},comments:[]}},methods:{getArticle:function(){var t=c()(a.a.mark(function t(){var s;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$http.get("/article/get",{params:{id:this.$route.params.id}});case 2:s=t.sent,console.log("archive",s),0===s.data.code&&(this.article=s.data.data,this.getComments(s.data.data.id));case 5:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),getComments:function(){var t=c()(a.a.mark(function t(s){var e;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$http.get("/comment/getById",{params:{id:s}});case 2:0===(e=t.sent).data.code&&(this.comments=e.data.data);case 4:case"end":return t.stop()}},t,this)}));return function(s){return t.apply(this,arguments)}}()},mounted:function(){this.getArticle()}},u=(e(224),Object(l.a)(m,function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"archive"},[e("div",{staticClass:"title"},[e("h1",[t._v(t._s(t.article.title))]),t._v(" "),e("div",{staticClass:"meta"},[e("router-link",{attrs:{to:""}},[e("span",{staticClass:"iconfont icon-fenlei"},[e("span",{staticClass:"green"},[t._v("APP")])])]),t._v(" "),e("router-link",{attrs:{to:""}},[e("span",{staticClass:"iconfont icon-gerenzhongxin1"},[e("span",{staticClass:"green"},[t._v(t._s(t.article.author))])])]),t._v(" "),e("span",{staticClass:"iconfont icon-shijian"},[t._v("2019-2-3")]),t._v(" "),e("router-link",{attrs:{to:""}},[e("span",{staticClass:"iconfont icon-pinglun"},[e("span",{staticClass:"green"},[t._v("2评论")])])])],1)]),t._v(" "),e("div",{staticClass:"content"},[e("div",{domProps:{innerHTML:t._s(t.article.content)}})]),t._v(" "),e("Comment",{attrs:{comments:t.comments,articleId:t.article.id},on:{getArticle:t.getArticle}})],1)},[],!1,null,"f62a2c70",null));s.default=u.exports},218:function(t,s,e){},219:function(t,s,e){},223:function(t,s,e){"use strict";var n=e(218);e.n(n).a},224:function(t,s,e){"use strict";var n=e(219);e.n(n).a}}]);